"use strict";var yi=Object.create;var Ve=Object.defineProperty;var gi=Object.getOwnPropertyDescriptor;var wi=Object.getOwnPropertyNames;var vi=Object.getPrototypeOf,Si=Object.prototype.hasOwnProperty;var F=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xi=(e,t)=>{for(var r in t)Ve(e,r,{get:t[r],enumerable:!0})},Vt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of wi(t))!Si.call(e,i)&&i!==r&&Ve(e,i,{get:()=>t[i],enumerable:!(n=gi(t,i))||n.enumerable});return e};var we=(e,t,r)=>(r=e!=null?yi(vi(e)):{},Vt(t||!e||!e.__esModule?Ve(r,"default",{value:e,enumerable:!0}):r,e)),Ti=e=>Vt(Ve({},"__esModule",{value:!0}),e);var Y=F(ot=>{"use strict";ot.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((r,n)=>{e.call(this,...t,(i,o)=>i!=null?n(i):r(o))})},"name",{value:e.name})};ot.fromPromise=function(e){return Object.defineProperty(function(...t){let r=t[t.length-1];if(typeof r!="function")return e.apply(this,t);e.apply(this,t.slice(0,-1)).then(n=>r(null,n),r)},"name",{value:e.name})}});var Mt=F((Js,$t)=>{var se=require("constants"),Ei=process.cwd,$e=null,Pi=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return $e||($e=Ei.call(process)),$e};try{process.cwd()}catch{}typeof process.chdir=="function"&&(st=process.chdir,process.chdir=function(e){$e=null,st.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,st));var st;$t.exports=ki;function ki(e){se.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=o(e.chown),e.fchown=o(e.fchown),e.lchown=o(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=i(e.chmodSync),e.fchmodSync=i(e.fchmodSync),e.lchmodSync=i(e.lchmodSync),e.stat=c(e.stat),e.fstat=c(e.fstat),e.lstat=c(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(u,f,l){l&&process.nextTick(l)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(u,f,l,d){d&&process.nextTick(d)},e.lchownSync=function(){}),Pi==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(u){function f(l,d,w){var v=Date.now(),T=0;u(l,d,function S(C){if(C&&(C.code==="EACCES"||C.code==="EPERM")&&Date.now()-v<6e4){setTimeout(function(){e.stat(d,function(P,G){P&&P.code==="ENOENT"?u(l,d,S):w(C)})},T),T<100&&(T+=10);return}w&&w(C)})}return Object.setPrototypeOf&&Object.setPrototypeOf(f,u),f}(e.rename)),e.read=typeof e.read!="function"?e.read:function(u){function f(l,d,w,v,T,S){var C;if(S&&typeof S=="function"){var P=0;C=function(G,re,X){if(G&&G.code==="EAGAIN"&&P<10)return P++,u.call(e,l,d,w,v,T,C);S.apply(this,arguments)}}return u.call(e,l,d,w,v,T,C)}return Object.setPrototypeOf&&Object.setPrototypeOf(f,u),f}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(u){return function(f,l,d,w,v){for(var T=0;;)try{return u.call(e,f,l,d,w,v)}catch(S){if(S.code==="EAGAIN"&&T<10){T++;continue}throw S}}}(e.readSync);function t(u){u.lchmod=function(f,l,d){u.open(f,se.O_WRONLY|se.O_SYMLINK,l,function(w,v){if(w){d&&d(w);return}u.fchmod(v,l,function(T){u.close(v,function(S){d&&d(T||S)})})})},u.lchmodSync=function(f,l){var d=u.openSync(f,se.O_WRONLY|se.O_SYMLINK,l),w=!0,v;try{v=u.fchmodSync(d,l),w=!1}finally{if(w)try{u.closeSync(d)}catch{}else u.closeSync(d)}return v}}function r(u){se.hasOwnProperty("O_SYMLINK")&&u.futimes?(u.lutimes=function(f,l,d,w){u.open(f,se.O_SYMLINK,function(v,T){if(v){w&&w(v);return}u.futimes(T,l,d,function(S){u.close(T,function(C){w&&w(S||C)})})})},u.lutimesSync=function(f,l,d){var w=u.openSync(f,se.O_SYMLINK),v,T=!0;try{v=u.futimesSync(w,l,d),T=!1}finally{if(T)try{u.closeSync(w)}catch{}else u.closeSync(w)}return v}):u.futimes&&(u.lutimes=function(f,l,d,w){w&&process.nextTick(w)},u.lutimesSync=function(){})}function n(u){return u&&function(f,l,d){return u.call(e,f,l,function(w){m(w)&&(w=null),d&&d.apply(this,arguments)})}}function i(u){return u&&function(f,l){try{return u.call(e,f,l)}catch(d){if(!m(d))throw d}}}function o(u){return u&&function(f,l,d,w){return u.call(e,f,l,d,function(v){m(v)&&(v=null),w&&w.apply(this,arguments)})}}function s(u){return u&&function(f,l,d){try{return u.call(e,f,l,d)}catch(w){if(!m(w))throw w}}}function c(u){return u&&function(f,l,d){typeof l=="function"&&(d=l,l=null);function w(v,T){T&&(T.uid<0&&(T.uid+=4294967296),T.gid<0&&(T.gid+=4294967296)),d&&d.apply(this,arguments)}return l?u.call(e,f,l,w):u.call(e,f,w)}}function a(u){return u&&function(f,l){var d=l?u.call(e,f,l):u.call(e,f);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function m(u){if(!u||u.code==="ENOSYS")return!0;var f=!process.getuid||process.getuid()!==0;return!!(f&&(u.code==="EINVAL"||u.code==="EPERM"))}}});var jt=F((Ks,Rt)=>{var Wt=require("stream").Stream;Rt.exports=Ci;function Ci(e){return{ReadStream:t,WriteStream:r};function t(n,i){if(!(this instanceof t))return new t(n,i);Wt.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var s=Object.keys(i),c=0,a=s.length;c<a;c++){var m=s[c];this[m]=i[m]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}e.open(this.path,this.flags,this.mode,function(u,f){if(u){o.emit("error",u),o.readable=!1;return}o.fd=f,o.emit("open",f),o._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);Wt.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),s=0,c=o.length;s<c;s++){var a=o[s];this[a]=i[a]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Gt=F((Ys,Lt)=>{"use strict";Lt.exports=Fi;var Ni=Object.getPrototypeOf||function(e){return e.__proto__};function Fi(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:Ni(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var U=F((Hs,ct)=>{var D=require("fs"),Ii=Mt(),bi=jt(),Oi=Gt(),Me=require("util"),L,Re;typeof Symbol=="function"&&typeof Symbol.for=="function"?(L=Symbol.for("graceful-fs.queue"),Re=Symbol.for("graceful-fs.previous")):(L="___graceful-fs.queue",Re="___graceful-fs.previous");function _i(){}function Jt(e,t){Object.defineProperty(e,L,{get:function(){return t}})}var me=_i;Me.debuglog?me=Me.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(me=function(){var e=Me.format.apply(Me,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});D[L]||(Bt=global[L]||[],Jt(D,Bt),D.close=function(e){function t(r,n){return e.call(D,r,function(i){i||Ut(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,Re,{value:e}),t}(D.close),D.closeSync=function(e){function t(r){e.apply(D,arguments),Ut()}return Object.defineProperty(t,Re,{value:e}),t}(D.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){me(D[L]),require("assert").equal(D[L].length,0)}));var Bt;global[L]||Jt(global,D[L]);ct.exports=at(Oi(D));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!D.__patched&&(ct.exports=at(D),D.__patched=!0);function at(e){Ii(e),e.gracefulify=at,e.createReadStream=re,e.createWriteStream=X;var t=e.readFile;e.readFile=r;function r(E,b,I){return typeof b=="function"&&(I=b,b=null),W(E,b,I);function W(q,A,y,h){return t(q,A,function(p){p&&(p.code==="EMFILE"||p.code==="ENFILE")?ve([W,[q,A,y],p,h||Date.now(),Date.now()]):typeof y=="function"&&y.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=i;function i(E,b,I,W){return typeof I=="function"&&(W=I,I=null),q(E,b,I,W);function q(A,y,h,p,g){return n(A,y,h,function(x){x&&(x.code==="EMFILE"||x.code==="ENFILE")?ve([q,[A,y,h,p],x,g||Date.now(),Date.now()]):typeof p=="function"&&p.apply(this,arguments)})}}var o=e.appendFile;o&&(e.appendFile=s);function s(E,b,I,W){return typeof I=="function"&&(W=I,I=null),q(E,b,I,W);function q(A,y,h,p,g){return o(A,y,h,function(x){x&&(x.code==="EMFILE"||x.code==="ENFILE")?ve([q,[A,y,h,p],x,g||Date.now(),Date.now()]):typeof p=="function"&&p.apply(this,arguments)})}}var c=e.copyFile;c&&(e.copyFile=a);function a(E,b,I,W){return typeof I=="function"&&(W=I,I=0),q(E,b,I,W);function q(A,y,h,p,g){return c(A,y,h,function(x){x&&(x.code==="EMFILE"||x.code==="ENFILE")?ve([q,[A,y,h,p],x,g||Date.now(),Date.now()]):typeof p=="function"&&p.apply(this,arguments)})}}var m=e.readdir;e.readdir=f;var u=/^v[0-5]\./;function f(E,b,I){typeof b=="function"&&(I=b,b=null);var W=u.test(process.version)?function(y,h,p,g){return m(y,q(y,h,p,g))}:function(y,h,p,g){return m(y,h,q(y,h,p,g))};return W(E,b,I);function q(A,y,h,p){return function(g,x){g&&(g.code==="EMFILE"||g.code==="ENFILE")?ve([W,[A,y,h],g,p||Date.now(),Date.now()]):(x&&x.sort&&x.sort(),typeof h=="function"&&h.call(this,g,x))}}}if(process.version.substr(0,4)==="v0.8"){var l=bi(e);S=l.ReadStream,P=l.WriteStream}var d=e.ReadStream;d&&(S.prototype=Object.create(d.prototype),S.prototype.open=C);var w=e.WriteStream;w&&(P.prototype=Object.create(w.prototype),P.prototype.open=G),Object.defineProperty(e,"ReadStream",{get:function(){return S},set:function(E){S=E},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return P},set:function(E){P=E},enumerable:!0,configurable:!0});var v=S;Object.defineProperty(e,"FileReadStream",{get:function(){return v},set:function(E){v=E},enumerable:!0,configurable:!0});var T=P;Object.defineProperty(e,"FileWriteStream",{get:function(){return T},set:function(E){T=E},enumerable:!0,configurable:!0});function S(E,b){return this instanceof S?(d.apply(this,arguments),this):S.apply(Object.create(S.prototype),arguments)}function C(){var E=this;oe(E.path,E.flags,E.mode,function(b,I){b?(E.autoClose&&E.destroy(),E.emit("error",b)):(E.fd=I,E.emit("open",I),E.read())})}function P(E,b){return this instanceof P?(w.apply(this,arguments),this):P.apply(Object.create(P.prototype),arguments)}function G(){var E=this;oe(E.path,E.flags,E.mode,function(b,I){b?(E.destroy(),E.emit("error",b)):(E.fd=I,E.emit("open",I))})}function re(E,b){return new e.ReadStream(E,b)}function X(E,b){return new e.WriteStream(E,b)}var Q=e.open;e.open=oe;function oe(E,b,I,W){return typeof I=="function"&&(W=I,I=null),q(E,b,I,W);function q(A,y,h,p,g){return Q(A,y,h,function(x,k){x&&(x.code==="EMFILE"||x.code==="ENFILE")?ve([q,[A,y,h,p],x,g||Date.now(),Date.now()]):typeof p=="function"&&p.apply(this,arguments)})}}return e}function ve(e){me("ENQUEUE",e[0].name,e[1]),D[L].push(e),ut()}var We;function Ut(){for(var e=Date.now(),t=0;t<D[L].length;++t)D[L][t].length>2&&(D[L][t][3]=e,D[L][t][4]=e);ut()}function ut(){if(clearTimeout(We),We=void 0,D[L].length!==0){var e=D[L].shift(),t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(i===void 0)me("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){me("TIMEOUT",t.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var c=Date.now()-o,a=Math.max(o-i,1),m=Math.min(a*1.2,100);c>=m?(me("RETRY",t.name,r),t.apply(null,r.concat([i]))):D[L].push(e)}We===void 0&&(We=setTimeout(ut,0))}}});var de=F(ae=>{"use strict";var Kt=Y().fromCallback,H=U(),qi=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof H[e]=="function");Object.assign(ae,H);qi.forEach(e=>{ae[e]=Kt(H[e])});ae.exists=function(e,t){return typeof t=="function"?H.exists(e,t):new Promise(r=>H.exists(e,r))};ae.read=function(e,t,r,n,i,o){return typeof o=="function"?H.read(e,t,r,n,i,o):new Promise((s,c)=>{H.read(e,t,r,n,i,(a,m,u)=>{if(a)return c(a);s({bytesRead:m,buffer:u})})})};ae.write=function(e,t,...r){return typeof r[r.length-1]=="function"?H.write(e,t,...r):new Promise((n,i)=>{H.write(e,t,...r,(o,s,c)=>{if(o)return i(o);n({bytesWritten:s,buffer:c})})})};typeof H.writev=="function"&&(ae.writev=function(e,t,...r){return typeof r[r.length-1]=="function"?H.writev(e,t,...r):new Promise((n,i)=>{H.writev(e,t,...r,(o,s,c)=>{if(o)return i(o);n({bytesWritten:s,buffers:c})})})});typeof H.realpath.native=="function"?ae.realpath.native=Kt(H.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var Ht=F((Qs,Yt)=>{"use strict";var Ai=require("path");Yt.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(Ai.parse(t).root,""))){let n=new Error(`Path contains invalid characters: ${t}`);throw n.code="EINVAL",n}}});var Zt=F((Xs,ft)=>{"use strict";var zt=de(),{checkPath:Qt}=Ht(),Xt=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};ft.exports.makeDir=async(e,t)=>(Qt(e),zt.mkdir(e,{mode:Xt(t),recursive:!0}));ft.exports.makeDirSync=(e,t)=>(Qt(e),zt.mkdirSync(e,{mode:Xt(t),recursive:!0}))});var ee=F((Zs,er)=>{"use strict";var Di=Y().fromPromise,{makeDir:Vi,makeDirSync:lt}=Zt(),ht=Di(Vi);er.exports={mkdirs:ht,mkdirsSync:lt,mkdirp:ht,mkdirpSync:lt,ensureDir:ht,ensureDirSync:lt}});var ue=F((ea,rr)=>{"use strict";var $i=Y().fromPromise,tr=de();function Mi(e){return tr.access(e).then(()=>!0).catch(()=>!1)}rr.exports={pathExists:$i(Mi),pathExistsSync:tr.existsSync}});var mt=F((ta,nr)=>{"use strict";var Se=U();function Wi(e,t,r,n){Se.open(e,"r+",(i,o)=>{if(i)return n(i);Se.futimes(o,t,r,s=>{Se.close(o,c=>{n&&n(s||c)})})})}function Ri(e,t,r){let n=Se.openSync(e,"r+");return Se.futimesSync(n,t,r),Se.closeSync(n)}nr.exports={utimesMillis:Wi,utimesMillisSync:Ri}});var pe=F((ra,sr)=>{"use strict";var xe=de(),j=require("path"),ji=require("util");function Li(e,t,r){let n=r.dereference?i=>xe.stat(i,{bigint:!0}):i=>xe.lstat(i,{bigint:!0});return Promise.all([n(e),n(t).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function Gi(e,t,r){let n,i=r.dereference?s=>xe.statSync(s,{bigint:!0}):s=>xe.lstatSync(s,{bigint:!0}),o=i(e);try{n=i(t)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:n}}function Bi(e,t,r,n,i){ji.callbackify(Li)(e,t,n,(o,s)=>{if(o)return i(o);let{srcStat:c,destStat:a}=s;if(a){if(Ee(c,a)){let m=j.basename(e),u=j.basename(t);return r==="move"&&m!==u&&m.toLowerCase()===u.toLowerCase()?i(null,{srcStat:c,destStat:a,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(c.isDirectory()&&!a.isDirectory())return i(new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`));if(!c.isDirectory()&&a.isDirectory())return i(new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`))}return c.isDirectory()&&dt(e,t)?i(new Error(je(e,t,r))):i(null,{srcStat:c,destStat:a})})}function Ui(e,t,r,n){let{srcStat:i,destStat:o}=Gi(e,t,n);if(o){if(Ee(i,o)){let s=j.basename(e),c=j.basename(t);if(r==="move"&&s!==c&&s.toLowerCase()===c.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&dt(e,t))throw new Error(je(e,t,r));return{srcStat:i,destStat:o}}function ir(e,t,r,n,i){let o=j.resolve(j.dirname(e)),s=j.resolve(j.dirname(r));if(s===o||s===j.parse(s).root)return i();xe.stat(s,{bigint:!0},(c,a)=>c?c.code==="ENOENT"?i():i(c):Ee(t,a)?i(new Error(je(e,r,n))):ir(e,t,s,n,i))}function or(e,t,r,n){let i=j.resolve(j.dirname(e)),o=j.resolve(j.dirname(r));if(o===i||o===j.parse(o).root)return;let s;try{s=xe.statSync(o,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Ee(t,s))throw new Error(je(e,r,n));return or(e,t,o,n)}function Ee(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function dt(e,t){let r=j.resolve(e).split(j.sep).filter(i=>i),n=j.resolve(t).split(j.sep).filter(i=>i);return r.reduce((i,o,s)=>i&&n[s]===o,!0)}function je(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}sr.exports={checkPaths:Bi,checkPathsSync:Ui,checkParentPaths:ir,checkParentPathsSync:or,isSrcSubdir:dt,areIdentical:Ee}});var dr=F((na,mr)=>{"use strict";var z=U(),Pe=require("path"),Ji=ee().mkdirs,Ki=ue().pathExists,Yi=mt().utimesMillis,ke=pe();function Hi(e,t,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),ke.checkPaths(e,t,"copy",r,(i,o)=>{if(i)return n(i);let{srcStat:s,destStat:c}=o;ke.checkParentPaths(e,s,t,"copy",a=>a?n(a):r.filter?cr(ar,c,e,t,r,n):ar(c,e,t,r,n))})}function ar(e,t,r,n,i){let o=Pe.dirname(r);Ki(o,(s,c)=>{if(s)return i(s);if(c)return Le(e,t,r,n,i);Ji(o,a=>a?i(a):Le(e,t,r,n,i))})}function cr(e,t,r,n,i,o){Promise.resolve(i.filter(r,n)).then(s=>s?e(t,r,n,i,o):o(),s=>o(s))}function zi(e,t,r,n,i){return n.filter?cr(Le,e,t,r,n,i):Le(e,t,r,n,i)}function Le(e,t,r,n,i){(n.dereference?z.stat:z.lstat)(t,(s,c)=>s?i(s):c.isDirectory()?no(c,e,t,r,n,i):c.isFile()||c.isCharacterDevice()||c.isBlockDevice()?Qi(c,e,t,r,n,i):c.isSymbolicLink()?so(e,t,r,n,i):c.isSocket()?i(new Error(`Cannot copy a socket file: ${t}`)):c.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${t}`)):i(new Error(`Unknown file: ${t}`)))}function Qi(e,t,r,n,i,o){return t?Xi(e,r,n,i,o):fr(e,r,n,i,o)}function Xi(e,t,r,n,i){if(n.overwrite)z.unlink(r,o=>o?i(o):fr(e,t,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function fr(e,t,r,n,i){z.copyFile(t,r,o=>o?i(o):n.preserveTimestamps?Zi(e.mode,t,r,i):Ge(r,e.mode,i))}function Zi(e,t,r,n){return eo(e)?to(r,e,i=>i?n(i):ur(e,t,r,n)):ur(e,t,r,n)}function eo(e){return(e&128)===0}function to(e,t,r){return Ge(e,t|128,r)}function ur(e,t,r,n){ro(t,r,i=>i?n(i):Ge(r,e,n))}function Ge(e,t,r){return z.chmod(e,t,r)}function ro(e,t,r){z.stat(e,(n,i)=>n?r(n):Yi(t,i.atime,i.mtime,r))}function no(e,t,r,n,i,o){return t?lr(r,n,i,o):io(e.mode,r,n,i,o)}function io(e,t,r,n,i){z.mkdir(r,o=>{if(o)return i(o);lr(t,r,n,s=>s?i(s):Ge(r,e,i))})}function lr(e,t,r,n){z.readdir(e,(i,o)=>i?n(i):hr(o,e,t,r,n))}function hr(e,t,r,n,i){let o=e.pop();return o?oo(e,o,t,r,n,i):i()}function oo(e,t,r,n,i,o){let s=Pe.join(r,t),c=Pe.join(n,t);ke.checkPaths(s,c,"copy",i,(a,m)=>{if(a)return o(a);let{destStat:u}=m;zi(u,s,c,i,f=>f?o(f):hr(e,r,n,i,o))})}function so(e,t,r,n,i){z.readlink(t,(o,s)=>{if(o)return i(o);if(n.dereference&&(s=Pe.resolve(process.cwd(),s)),e)z.readlink(r,(c,a)=>c?c.code==="EINVAL"||c.code==="UNKNOWN"?z.symlink(s,r,i):i(c):(n.dereference&&(a=Pe.resolve(process.cwd(),a)),ke.isSrcSubdir(s,a)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${a}'.`)):e.isDirectory()&&ke.isSrcSubdir(a,s)?i(new Error(`Cannot overwrite '${a}' with '${s}'.`)):ao(s,r,i)));else return z.symlink(s,r,i)})}function ao(e,t,r){z.unlink(t,n=>n?r(n):z.symlink(e,t,r))}mr.exports=Hi});var vr=F((ia,wr)=>{"use strict";var B=U(),Ce=require("path"),uo=ee().mkdirsSync,co=mt().utimesMillisSync,Ne=pe();function fo(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=Ne.checkPathsSync(e,t,"copy",r);return Ne.checkParentPathsSync(e,n,t,"copy"),lo(i,e,t,r)}function lo(e,t,r,n){if(n.filter&&!n.filter(t,r))return;let i=Ce.dirname(r);return B.existsSync(i)||uo(i),pr(e,t,r,n)}function ho(e,t,r,n){if(!(n.filter&&!n.filter(t,r)))return pr(e,t,r,n)}function pr(e,t,r,n){let o=(n.dereference?B.statSync:B.lstatSync)(t);if(o.isDirectory())return So(o,e,t,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return mo(o,e,t,r,n);if(o.isSymbolicLink())return Eo(e,t,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function mo(e,t,r,n,i){return t?po(e,r,n,i):yr(e,r,n,i)}function po(e,t,r,n){if(n.overwrite)return B.unlinkSync(r),yr(e,t,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function yr(e,t,r,n){return B.copyFileSync(t,r),n.preserveTimestamps&&yo(e.mode,t,r),pt(r,e.mode)}function yo(e,t,r){return go(e)&&wo(r,e),vo(t,r)}function go(e){return(e&128)===0}function wo(e,t){return pt(e,t|128)}function pt(e,t){return B.chmodSync(e,t)}function vo(e,t){let r=B.statSync(e);return co(t,r.atime,r.mtime)}function So(e,t,r,n,i){return t?gr(r,n,i):xo(e.mode,r,n,i)}function xo(e,t,r,n){return B.mkdirSync(r),gr(t,r,n),pt(r,e)}function gr(e,t,r){B.readdirSync(e).forEach(n=>To(n,e,t,r))}function To(e,t,r,n){let i=Ce.join(t,e),o=Ce.join(r,e),{destStat:s}=Ne.checkPathsSync(i,o,"copy",n);return ho(s,i,o,n)}function Eo(e,t,r,n){let i=B.readlinkSync(t);if(n.dereference&&(i=Ce.resolve(process.cwd(),i)),e){let o;try{o=B.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return B.symlinkSync(i,r);throw s}if(n.dereference&&(o=Ce.resolve(process.cwd(),o)),Ne.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(B.statSync(r).isDirectory()&&Ne.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return Po(i,r)}else return B.symlinkSync(i,r)}function Po(e,t){return B.unlinkSync(t),B.symlinkSync(e,t)}wr.exports=fo});var Be=F((oa,Sr)=>{"use strict";var ko=Y().fromCallback;Sr.exports={copy:ko(dr()),copySync:vr()}});var Ir=F((sa,Fr)=>{"use strict";var xr=U(),kr=require("path"),_=require("assert"),Fe=process.platform==="win32";function Cr(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{e[r]=e[r]||xr[r],r=r+"Sync",e[r]=e[r]||xr[r]}),e.maxBusyTries=e.maxBusyTries||3}function yt(e,t,r){let n=0;typeof t=="function"&&(r=t,t={}),_(e,"rimraf: missing path"),_.strictEqual(typeof e,"string","rimraf: path should be a string"),_.strictEqual(typeof r,"function","rimraf: callback function required"),_(t,"rimraf: invalid options argument provided"),_.strictEqual(typeof t,"object","rimraf: options should be object"),Cr(t),Tr(e,t,function i(o){if(o){if((o.code==="EBUSY"||o.code==="ENOTEMPTY"||o.code==="EPERM")&&n<t.maxBusyTries){n++;let s=n*100;return setTimeout(()=>Tr(e,t,i),s)}o.code==="ENOENT"&&(o=null)}r(o)})}function Tr(e,t,r){_(e),_(t),_(typeof r=="function"),t.lstat(e,(n,i)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&Fe)return Er(e,t,n,r);if(i&&i.isDirectory())return Ue(e,t,n,r);t.unlink(e,o=>{if(o){if(o.code==="ENOENT")return r(null);if(o.code==="EPERM")return Fe?Er(e,t,o,r):Ue(e,t,o,r);if(o.code==="EISDIR")return Ue(e,t,o,r)}return r(o)})})}function Er(e,t,r,n){_(e),_(t),_(typeof n=="function"),t.chmod(e,438,i=>{i?n(i.code==="ENOENT"?null:r):t.stat(e,(o,s)=>{o?n(o.code==="ENOENT"?null:r):s.isDirectory()?Ue(e,t,r,n):t.unlink(e,n)})})}function Pr(e,t,r){let n;_(e),_(t);try{t.chmodSync(e,438)}catch(i){if(i.code==="ENOENT")return;throw r}try{n=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?Je(e,t,r):t.unlinkSync(e)}function Ue(e,t,r,n){_(e),_(t),_(typeof n=="function"),t.rmdir(e,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?Co(e,t,n):i&&i.code==="ENOTDIR"?n(r):n(i)})}function Co(e,t,r){_(e),_(t),_(typeof r=="function"),t.readdir(e,(n,i)=>{if(n)return r(n);let o=i.length,s;if(o===0)return t.rmdir(e,r);i.forEach(c=>{yt(kr.join(e,c),t,a=>{if(!s){if(a)return r(s=a);--o===0&&t.rmdir(e,r)}})})})}function Nr(e,t){let r;t=t||{},Cr(t),_(e,"rimraf: missing path"),_.strictEqual(typeof e,"string","rimraf: path should be a string"),_(t,"rimraf: missing options"),_.strictEqual(typeof t,"object","rimraf: options should be object");try{r=t.lstatSync(e)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&Fe&&Pr(e,t,n)}try{r&&r.isDirectory()?Je(e,t,null):t.unlinkSync(e)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return Fe?Pr(e,t,n):Je(e,t,n);if(n.code!=="EISDIR")throw n;Je(e,t,n)}}function Je(e,t,r){_(e),_(t);try{t.rmdirSync(e)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")No(e,t);else if(n.code!=="ENOENT")throw n}}function No(e,t){if(_(e),_(t),t.readdirSync(e).forEach(r=>Nr(kr.join(e,r),t)),Fe){let r=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-r<500)}else return t.rmdirSync(e,t)}Fr.exports=yt;yt.sync=Nr});var Ie=F((aa,Or)=>{"use strict";var Ke=U(),Fo=Y().fromCallback,br=Ir();function Io(e,t){if(Ke.rm)return Ke.rm(e,{recursive:!0,force:!0},t);br(e,t)}function bo(e){if(Ke.rmSync)return Ke.rmSync(e,{recursive:!0,force:!0});br.sync(e)}Or.exports={remove:Fo(Io),removeSync:bo}});var Wr=F((ua,Mr)=>{"use strict";var Oo=Y().fromPromise,Ar=de(),Dr=require("path"),Vr=ee(),$r=Ie(),_r=Oo(async function(t){let r;try{r=await Ar.readdir(t)}catch{return Vr.mkdirs(t)}return Promise.all(r.map(n=>$r.remove(Dr.join(t,n))))});function qr(e){let t;try{t=Ar.readdirSync(e)}catch{return Vr.mkdirsSync(e)}t.forEach(r=>{r=Dr.join(e,r),$r.removeSync(r)})}Mr.exports={emptyDirSync:qr,emptydirSync:qr,emptyDir:_r,emptydir:_r}});var Gr=F((ca,Lr)=>{"use strict";var _o=Y().fromCallback,Rr=require("path"),ce=U(),jr=ee();function qo(e,t){function r(){ce.writeFile(e,"",n=>{if(n)return t(n);t()})}ce.stat(e,(n,i)=>{if(!n&&i.isFile())return t();let o=Rr.dirname(e);ce.stat(o,(s,c)=>{if(s)return s.code==="ENOENT"?jr.mkdirs(o,a=>{if(a)return t(a);r()}):t(s);c.isDirectory()?r():ce.readdir(o,a=>{if(a)return t(a)})})})}function Ao(e){let t;try{t=ce.statSync(e)}catch{}if(t&&t.isFile())return;let r=Rr.dirname(e);try{ce.statSync(r).isDirectory()||ce.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")jr.mkdirsSync(r);else throw n}ce.writeFileSync(e,"")}Lr.exports={createFile:_o(qo),createFileSync:Ao}});var Yr=F((fa,Kr)=>{"use strict";var Do=Y().fromCallback,Br=require("path"),fe=U(),Ur=ee(),Vo=ue().pathExists,{areIdentical:Jr}=pe();function $o(e,t,r){function n(i,o){fe.link(i,o,s=>{if(s)return r(s);r(null)})}fe.lstat(t,(i,o)=>{fe.lstat(e,(s,c)=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),r(s);if(o&&Jr(c,o))return r(null);let a=Br.dirname(t);Vo(a,(m,u)=>{if(m)return r(m);if(u)return n(e,t);Ur.mkdirs(a,f=>{if(f)return r(f);n(e,t)})})})})}function Mo(e,t){let r;try{r=fe.lstatSync(t)}catch{}try{let o=fe.lstatSync(e);if(r&&Jr(o,r))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let n=Br.dirname(t);return fe.existsSync(n)||Ur.mkdirsSync(n),fe.linkSync(e,t)}Kr.exports={createLink:Do($o),createLinkSync:Mo}});var zr=F((la,Hr)=>{"use strict";var le=require("path"),be=U(),Wo=ue().pathExists;function Ro(e,t,r){if(le.isAbsolute(e))return be.lstat(e,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:e,toDst:e}));{let n=le.dirname(t),i=le.join(n,e);return Wo(i,(o,s)=>o?r(o):s?r(null,{toCwd:i,toDst:e}):be.lstat(e,c=>c?(c.message=c.message.replace("lstat","ensureSymlink"),r(c)):r(null,{toCwd:e,toDst:le.relative(n,e)})))}}function jo(e,t){let r;if(le.isAbsolute(e)){if(r=be.existsSync(e),!r)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let n=le.dirname(t),i=le.join(n,e);if(r=be.existsSync(i),r)return{toCwd:i,toDst:e};if(r=be.existsSync(e),!r)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:le.relative(n,e)}}}Hr.exports={symlinkPaths:Ro,symlinkPathsSync:jo}});var Zr=F((ha,Xr)=>{"use strict";var Qr=U();function Lo(e,t,r){if(r=typeof t=="function"?t:r,t=typeof t=="function"?!1:t,t)return r(null,t);Qr.lstat(e,(n,i)=>{if(n)return r(null,"file");t=i&&i.isDirectory()?"dir":"file",r(null,t)})}function Go(e,t){let r;if(t)return t;try{r=Qr.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Xr.exports={symlinkType:Lo,symlinkTypeSync:Go}});var un=F((ma,an)=>{"use strict";var Bo=Y().fromCallback,tn=require("path"),te=de(),rn=ee(),Uo=rn.mkdirs,Jo=rn.mkdirsSync,nn=zr(),Ko=nn.symlinkPaths,Yo=nn.symlinkPathsSync,on=Zr(),Ho=on.symlinkType,zo=on.symlinkTypeSync,Qo=ue().pathExists,{areIdentical:sn}=pe();function Xo(e,t,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,te.lstat(t,(i,o)=>{!i&&o.isSymbolicLink()?Promise.all([te.stat(e),te.stat(t)]).then(([s,c])=>{if(sn(s,c))return n(null);en(e,t,r,n)}):en(e,t,r,n)})}function en(e,t,r,n){Ko(e,t,(i,o)=>{if(i)return n(i);e=o.toDst,Ho(o.toCwd,r,(s,c)=>{if(s)return n(s);let a=tn.dirname(t);Qo(a,(m,u)=>{if(m)return n(m);if(u)return te.symlink(e,t,c,n);Uo(a,f=>{if(f)return n(f);te.symlink(e,t,c,n)})})})})}function Zo(e,t,r){let n;try{n=te.lstatSync(t)}catch{}if(n&&n.isSymbolicLink()){let c=te.statSync(e),a=te.statSync(t);if(sn(c,a))return}let i=Yo(e,t);e=i.toDst,r=zo(i.toCwd,r);let o=tn.dirname(t);return te.existsSync(o)||Jo(o),te.symlinkSync(e,t,r)}an.exports={createSymlink:Bo(Xo),createSymlinkSync:Zo}});var yn=F((da,pn)=>{"use strict";var{createFile:cn,createFileSync:fn}=Gr(),{createLink:ln,createLinkSync:hn}=Yr(),{createSymlink:mn,createSymlinkSync:dn}=un();pn.exports={createFile:cn,createFileSync:fn,ensureFile:cn,ensureFileSync:fn,createLink:ln,createLinkSync:hn,ensureLink:ln,ensureLinkSync:hn,createSymlink:mn,createSymlinkSync:dn,ensureSymlink:mn,ensureSymlinkSync:dn}});var Ye=F((pa,gn)=>{function es(e,{EOL:t=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){let o=r?t:"";return JSON.stringify(e,n,i).replace(/\n/g,t)+o}function ts(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}gn.exports={stringify:es,stripBom:ts}});var xn=F((ya,Sn)=>{var Te;try{Te=U()}catch{Te=require("fs")}var He=Y(),{stringify:wn,stripBom:vn}=Ye();async function rs(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||Te,n="throws"in t?t.throws:!0,i=await He.fromCallback(r.readFile)(e,t);i=vn(i);let o;try{o=JSON.parse(i,t?t.reviver:null)}catch(s){if(n)throw s.message=`${e}: ${s.message}`,s;return null}return o}var ns=He.fromPromise(rs);function is(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||Te,n="throws"in t?t.throws:!0;try{let i=r.readFileSync(e,t);return i=vn(i),JSON.parse(i,t.reviver)}catch(i){if(n)throw i.message=`${e}: ${i.message}`,i;return null}}async function os(e,t,r={}){let n=r.fs||Te,i=wn(t,r);await He.fromCallback(n.writeFile)(e,i,r)}var ss=He.fromPromise(os);function as(e,t,r={}){let n=r.fs||Te,i=wn(t,r);return n.writeFileSync(e,i,r)}var us={readFile:ns,readFileSync:is,writeFile:ss,writeFileSync:as};Sn.exports=us});var En=F((ga,Tn)=>{"use strict";var ze=xn();Tn.exports={readJson:ze.readFile,readJsonSync:ze.readFileSync,writeJson:ze.writeFile,writeJsonSync:ze.writeFileSync}});var Qe=F((wa,Cn)=>{"use strict";var cs=Y().fromCallback,Oe=U(),Pn=require("path"),kn=ee(),fs=ue().pathExists;function ls(e,t,r,n){typeof r=="function"&&(n=r,r="utf8");let i=Pn.dirname(e);fs(i,(o,s)=>{if(o)return n(o);if(s)return Oe.writeFile(e,t,r,n);kn.mkdirs(i,c=>{if(c)return n(c);Oe.writeFile(e,t,r,n)})})}function hs(e,...t){let r=Pn.dirname(e);if(Oe.existsSync(r))return Oe.writeFileSync(e,...t);kn.mkdirsSync(r),Oe.writeFileSync(e,...t)}Cn.exports={outputFile:cs(ls),outputFileSync:hs}});var Fn=F((va,Nn)=>{"use strict";var{stringify:ms}=Ye(),{outputFile:ds}=Qe();async function ps(e,t,r={}){let n=ms(t,r);await ds(e,n,r)}Nn.exports=ps});var bn=F((Sa,In)=>{"use strict";var{stringify:ys}=Ye(),{outputFileSync:gs}=Qe();function ws(e,t,r){let n=ys(t,r);gs(e,n,r)}In.exports=ws});var _n=F((xa,On)=>{"use strict";var vs=Y().fromPromise,J=En();J.outputJson=vs(Fn());J.outputJsonSync=bn();J.outputJSON=J.outputJson;J.outputJSONSync=J.outputJsonSync;J.writeJSON=J.writeJson;J.writeJSONSync=J.writeJsonSync;J.readJSON=J.readJson;J.readJSONSync=J.readJsonSync;On.exports=J});var $n=F((Ta,Vn)=>{"use strict";var Ss=U(),wt=require("path"),xs=Be().copy,Dn=Ie().remove,Ts=ee().mkdirp,Es=ue().pathExists,qn=pe();function Ps(e,t,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};let i=r.overwrite||r.clobber||!1;qn.checkPaths(e,t,"move",r,(o,s)=>{if(o)return n(o);let{srcStat:c,isChangingCase:a=!1}=s;qn.checkParentPaths(e,c,t,"move",m=>{if(m)return n(m);if(ks(t))return An(e,t,i,a,n);Ts(wt.dirname(t),u=>u?n(u):An(e,t,i,a,n))})})}function ks(e){let t=wt.dirname(e);return wt.parse(t).root===t}function An(e,t,r,n,i){if(n)return gt(e,t,r,i);if(r)return Dn(t,o=>o?i(o):gt(e,t,r,i));Es(t,(o,s)=>o?i(o):s?i(new Error("dest already exists.")):gt(e,t,r,i))}function gt(e,t,r,n){Ss.rename(e,t,i=>i?i.code!=="EXDEV"?n(i):Cs(e,t,r,n):n())}function Cs(e,t,r,n){xs(e,t,{overwrite:r,errorOnExist:!0},o=>o?n(o):Dn(e,n))}Vn.exports=Ps});var Ln=F((Ea,jn)=>{"use strict";var Wn=U(),St=require("path"),Ns=Be().copySync,Rn=Ie().removeSync,Fs=ee().mkdirpSync,Mn=pe();function Is(e,t,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=Mn.checkPathsSync(e,t,"move",r);return Mn.checkParentPathsSync(e,i,t,"move"),bs(t)||Fs(St.dirname(t)),Os(e,t,n,o)}function bs(e){let t=St.dirname(e);return St.parse(t).root===t}function Os(e,t,r,n){if(n)return vt(e,t,r);if(r)return Rn(t),vt(e,t,r);if(Wn.existsSync(t))throw new Error("dest already exists.");return vt(e,t,r)}function vt(e,t,r){try{Wn.renameSync(e,t)}catch(n){if(n.code!=="EXDEV")throw n;return _s(e,t,r)}}function _s(e,t,r){return Ns(e,t,{overwrite:r,errorOnExist:!0}),Rn(e)}jn.exports=Is});var Bn=F((Pa,Gn)=>{"use strict";var qs=Y().fromCallback;Gn.exports={move:qs($n()),moveSync:Ln()}});var _e=F((ka,Un)=>{"use strict";Un.exports={...de(),...Be(),...Wr(),...yn(),..._n(),...ee(),...Bn(),...Qe(),...ue(),...Ie()}});var Gs={};xi(Gs,{activate:()=>js,log:()=>qe});module.exports=Ti(Gs);var Kn=require("coc.nvim"),Yn=we(_e()),Hn=require("path"),xt=(0,Yn.readJsonSync)((0,Hn.resolve)("/home/hexh/workspace/coc-todo-tree/src","../package.json")),As=xt.contributes.configuration.properties["todo-tree.defaultView"].enum,zn=xt.name,Xe=Kn.workspace.getConfiguration().get("todo-tree"),Jn=xt.contributes.configuration.properties,Ds=Object.keys(Jn).reduce((e,t)=>(e[t.replace(new RegExp(`${zn.replace("coc-","")}\\.`),"")]=Jn[t].default,e),{}),Qn={};Xe&&Xe.tags&&(Qn.tags=Xe.tags.filter((e,t,r)=>r.findIndex(n=>n.tagName===e.tagName)===t));var Z=As,ie=zn,ye=Ds,N={...Xe,...Qn};var V=require("coc.nvim"),li=we(_e()),hi=we(require("path"));var Xn;(()=>{"use strict";var e={470:i=>{function o(a){if(typeof a!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(a))}function s(a,m){for(var u,f="",l=0,d=-1,w=0,v=0;v<=a.length;++v){if(v<a.length)u=a.charCodeAt(v);else{if(u===47)break;u=47}if(u===47){if(!(d===v-1||w===1))if(d!==v-1&&w===2){if(f.length<2||l!==2||f.charCodeAt(f.length-1)!==46||f.charCodeAt(f.length-2)!==46){if(f.length>2){var T=f.lastIndexOf("/");if(T!==f.length-1){T===-1?(f="",l=0):l=(f=f.slice(0,T)).length-1-f.lastIndexOf("/"),d=v,w=0;continue}}else if(f.length===2||f.length===1){f="",l=0,d=v,w=0;continue}}m&&(f.length>0?f+="/..":f="..",l=2)}else f.length>0?f+="/"+a.slice(d+1,v):f=a.slice(d+1,v),l=v-d-1;d=v,w=0}else u===46&&w!==-1?++w:w=-1}return f}var c={resolve:function(){for(var a,m="",u=!1,f=arguments.length-1;f>=-1&&!u;f--){var l;f>=0?l=arguments[f]:(a===void 0&&(a=process.cwd()),l=a),o(l),l.length!==0&&(m=l+"/"+m,u=l.charCodeAt(0)===47)}return m=s(m,!u),u?m.length>0?"/"+m:"/":m.length>0?m:"."},normalize:function(a){if(o(a),a.length===0)return".";var m=a.charCodeAt(0)===47,u=a.charCodeAt(a.length-1)===47;return(a=s(a,!m)).length!==0||m||(a="."),a.length>0&&u&&(a+="/"),m?"/"+a:a},isAbsolute:function(a){return o(a),a.length>0&&a.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var a,m=0;m<arguments.length;++m){var u=arguments[m];o(u),u.length>0&&(a===void 0?a=u:a+="/"+u)}return a===void 0?".":c.normalize(a)},relative:function(a,m){if(o(a),o(m),a===m||(a=c.resolve(a))===(m=c.resolve(m)))return"";for(var u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var f=a.length,l=f-u,d=1;d<m.length&&m.charCodeAt(d)===47;++d);for(var w=m.length-d,v=l<w?l:w,T=-1,S=0;S<=v;++S){if(S===v){if(w>v){if(m.charCodeAt(d+S)===47)return m.slice(d+S+1);if(S===0)return m.slice(d+S)}else l>v&&(a.charCodeAt(u+S)===47?T=S:S===0&&(T=0));break}var C=a.charCodeAt(u+S);if(C!==m.charCodeAt(d+S))break;C===47&&(T=S)}var P="";for(S=u+T+1;S<=f;++S)S!==f&&a.charCodeAt(S)!==47||(P.length===0?P+="..":P+="/..");return P.length>0?P+m.slice(d+T):(d+=T,m.charCodeAt(d)===47&&++d,m.slice(d))},_makeLong:function(a){return a},dirname:function(a){if(o(a),a.length===0)return".";for(var m=a.charCodeAt(0),u=m===47,f=-1,l=!0,d=a.length-1;d>=1;--d)if((m=a.charCodeAt(d))===47){if(!l){f=d;break}}else l=!1;return f===-1?u?"/":".":u&&f===1?"//":a.slice(0,f)},basename:function(a,m){if(m!==void 0&&typeof m!="string")throw new TypeError('"ext" argument must be a string');o(a);var u,f=0,l=-1,d=!0;if(m!==void 0&&m.length>0&&m.length<=a.length){if(m.length===a.length&&m===a)return"";var w=m.length-1,v=-1;for(u=a.length-1;u>=0;--u){var T=a.charCodeAt(u);if(T===47){if(!d){f=u+1;break}}else v===-1&&(d=!1,v=u+1),w>=0&&(T===m.charCodeAt(w)?--w==-1&&(l=u):(w=-1,l=v))}return f===l?l=v:l===-1&&(l=a.length),a.slice(f,l)}for(u=a.length-1;u>=0;--u)if(a.charCodeAt(u)===47){if(!d){f=u+1;break}}else l===-1&&(d=!1,l=u+1);return l===-1?"":a.slice(f,l)},extname:function(a){o(a);for(var m=-1,u=0,f=-1,l=!0,d=0,w=a.length-1;w>=0;--w){var v=a.charCodeAt(w);if(v!==47)f===-1&&(l=!1,f=w+1),v===46?m===-1?m=w:d!==1&&(d=1):m!==-1&&(d=-1);else if(!l){u=w+1;break}}return m===-1||f===-1||d===0||d===1&&m===f-1&&m===u+1?"":a.slice(m,f)},format:function(a){if(a===null||typeof a!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof a);return function(m,u){var f=u.dir||u.root,l=u.base||(u.name||"")+(u.ext||"");return f?f===u.root?f+l:f+"/"+l:l}(0,a)},parse:function(a){o(a);var m={root:"",dir:"",base:"",ext:"",name:""};if(a.length===0)return m;var u,f=a.charCodeAt(0),l=f===47;l?(m.root="/",u=1):u=0;for(var d=-1,w=0,v=-1,T=!0,S=a.length-1,C=0;S>=u;--S)if((f=a.charCodeAt(S))!==47)v===-1&&(T=!1,v=S+1),f===46?d===-1?d=S:C!==1&&(C=1):d!==-1&&(C=-1);else if(!T){w=S+1;break}return d===-1||v===-1||C===0||C===1&&d===v-1&&d===w+1?v!==-1&&(m.base=m.name=w===0&&l?a.slice(1,v):a.slice(w,v)):(w===0&&l?(m.name=a.slice(1,d),m.base=a.slice(1,v)):(m.name=a.slice(w,d),m.base=a.slice(w,v)),m.ext=a.slice(d,v)),w>0?m.dir=a.slice(0,w-1):l&&(m.dir="/"),m},sep:"/",delimiter:":",win32:null,posix:null};c.posix=c,i.exports=c}},t={};function r(i){var o=t[i];if(o!==void 0)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,r),s.exports}r.d=(i,o)=>{for(var s in o)r.o(o,s)&&!r.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:o[s]})},r.o=(i,o)=>Object.prototype.hasOwnProperty.call(i,o),r.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var n={};(()=>{var i;if(r.r(n),r.d(n,{URI:()=>v,Utils:()=>b}),typeof process=="object")i=process.platform==="win32";else if(typeof navigator=="object"){var o=navigator.userAgent;i=o.indexOf("Windows")>=0}var s,c,a=(s=function(y,h){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&(p[x]=g[x])},s(y,h)},function(y,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");function p(){this.constructor=y}s(y,h),y.prototype=h===null?Object.create(h):(p.prototype=h.prototype,new p)}),m=/^\w[\w\d+.-]*$/,u=/^\//,f=/^\/\//,l="",d="/",w=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,v=function(){function y(h,p,g,x,k,O){O===void 0&&(O=!1),typeof h=="object"?(this.scheme=h.scheme||l,this.authority=h.authority||l,this.path=h.path||l,this.query=h.query||l,this.fragment=h.fragment||l):(this.scheme=function(R,K){return R||K?R:"file"}(h,O),this.authority=p||l,this.path=function(R,K){switch(R){case"https":case"http":case"file":K?K[0]!==d&&(K=d+K):K=d}return K}(this.scheme,g||l),this.query=x||l,this.fragment=k||l,function(R,K){if(!R.scheme&&K)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'.concat(R.authority,'", path: "').concat(R.path,'", query: "').concat(R.query,'", fragment: "').concat(R.fragment,'"}'));if(R.scheme&&!m.test(R.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(R.path){if(R.authority){if(!u.test(R.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(f.test(R.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}(this,O))}return y.isUri=function(h){return h instanceof y||!!h&&typeof h.authority=="string"&&typeof h.fragment=="string"&&typeof h.path=="string"&&typeof h.query=="string"&&typeof h.scheme=="string"&&typeof h.fsPath=="string"&&typeof h.with=="function"&&typeof h.toString=="function"},Object.defineProperty(y.prototype,"fsPath",{get:function(){return re(this,!1)},enumerable:!1,configurable:!0}),y.prototype.with=function(h){if(!h)return this;var p=h.scheme,g=h.authority,x=h.path,k=h.query,O=h.fragment;return p===void 0?p=this.scheme:p===null&&(p=l),g===void 0?g=this.authority:g===null&&(g=l),x===void 0?x=this.path:x===null&&(x=l),k===void 0?k=this.query:k===null&&(k=l),O===void 0?O=this.fragment:O===null&&(O=l),p===this.scheme&&g===this.authority&&x===this.path&&k===this.query&&O===this.fragment?this:new S(p,g,x,k,O)},y.parse=function(h,p){p===void 0&&(p=!1);var g=w.exec(h);return g?new S(g[2]||l,E(g[4]||l),E(g[5]||l),E(g[7]||l),E(g[9]||l),p):new S(l,l,l,l,l)},y.file=function(h){var p=l;if(i&&(h=h.replace(/\\/g,d)),h[0]===d&&h[1]===d){var g=h.indexOf(d,2);g===-1?(p=h.substring(2),h=d):(p=h.substring(2,g),h=h.substring(g)||d)}return new S("file",p,h,l,l)},y.from=function(h){return new S(h.scheme,h.authority,h.path,h.query,h.fragment)},y.prototype.toString=function(h){return h===void 0&&(h=!1),X(this,h)},y.prototype.toJSON=function(){return this},y.revive=function(h){if(h){if(h instanceof y)return h;var p=new S(h);return p._formatted=h.external,p._fsPath=h._sep===T?h.fsPath:null,p}return h},y}(),T=i?1:void 0,S=function(y){function h(){var p=y!==null&&y.apply(this,arguments)||this;return p._formatted=null,p._fsPath=null,p}return a(h,y),Object.defineProperty(h.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=re(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),h.prototype.toString=function(p){return p===void 0&&(p=!1),p?X(this,!0):(this._formatted||(this._formatted=X(this,!1)),this._formatted)},h.prototype.toJSON=function(){var p={$mid:1};return this._fsPath&&(p.fsPath=this._fsPath,p._sep=T),this._formatted&&(p.external=this._formatted),this.path&&(p.path=this.path),this.scheme&&(p.scheme=this.scheme),this.authority&&(p.authority=this.authority),this.query&&(p.query=this.query),this.fragment&&(p.fragment=this.fragment),p},h}(v),C=((c={})[58]="%3A",c[47]="%2F",c[63]="%3F",c[35]="%23",c[91]="%5B",c[93]="%5D",c[64]="%40",c[33]="%21",c[36]="%24",c[38]="%26",c[39]="%27",c[40]="%28",c[41]="%29",c[42]="%2A",c[43]="%2B",c[44]="%2C",c[59]="%3B",c[61]="%3D",c[32]="%20",c);function P(y,h){for(var p=void 0,g=-1,x=0;x<y.length;x++){var k=y.charCodeAt(x);if(k>=97&&k<=122||k>=65&&k<=90||k>=48&&k<=57||k===45||k===46||k===95||k===126||h&&k===47)g!==-1&&(p+=encodeURIComponent(y.substring(g,x)),g=-1),p!==void 0&&(p+=y.charAt(x));else{p===void 0&&(p=y.substr(0,x));var O=C[k];O!==void 0?(g!==-1&&(p+=encodeURIComponent(y.substring(g,x)),g=-1),p+=O):g===-1&&(g=x)}}return g!==-1&&(p+=encodeURIComponent(y.substring(g))),p!==void 0?p:y}function G(y){for(var h=void 0,p=0;p<y.length;p++){var g=y.charCodeAt(p);g===35||g===63?(h===void 0&&(h=y.substr(0,p)),h+=C[g]):h!==void 0&&(h+=y[p])}return h!==void 0?h:y}function re(y,h){var p;return p=y.authority&&y.path.length>1&&y.scheme==="file"?"//".concat(y.authority).concat(y.path):y.path.charCodeAt(0)===47&&(y.path.charCodeAt(1)>=65&&y.path.charCodeAt(1)<=90||y.path.charCodeAt(1)>=97&&y.path.charCodeAt(1)<=122)&&y.path.charCodeAt(2)===58?h?y.path.substr(1):y.path[1].toLowerCase()+y.path.substr(2):y.path,i&&(p=p.replace(/\//g,"\\")),p}function X(y,h){var p=h?G:P,g="",x=y.scheme,k=y.authority,O=y.path,R=y.query,K=y.fragment;if(x&&(g+=x,g+=":"),(k||x==="file")&&(g+=d,g+=d),k){var ne=k.indexOf("@");if(ne!==-1){var De=k.substr(0,ne);k=k.substr(ne+1),(ne=De.indexOf(":"))===-1?g+=p(De,!1):(g+=p(De.substr(0,ne),!1),g+=":",g+=p(De.substr(ne+1),!1)),g+="@"}(ne=(k=k.toLowerCase()).indexOf(":"))===-1?g+=p(k,!1):(g+=p(k.substr(0,ne),!1),g+=k.substr(ne))}if(O){if(O.length>=3&&O.charCodeAt(0)===47&&O.charCodeAt(2)===58)(ge=O.charCodeAt(1))>=65&&ge<=90&&(O="/".concat(String.fromCharCode(ge+32),":").concat(O.substr(3)));else if(O.length>=2&&O.charCodeAt(1)===58){var ge;(ge=O.charCodeAt(0))>=65&&ge<=90&&(O="".concat(String.fromCharCode(ge+32),":").concat(O.substr(2)))}g+=p(O,!0)}return R&&(g+="?",g+=p(R,!1)),K&&(g+="#",g+=h?K:P(K,!1)),g}function Q(y){try{return decodeURIComponent(y)}catch{return y.length>3?y.substr(0,3)+Q(y.substr(3)):y}}var oe=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function E(y){return y.match(oe)?y.replace(oe,function(h){return Q(h)}):y}var b,I=r(470),W=function(y,h,p){if(p||arguments.length===2)for(var g,x=0,k=h.length;x<k;x++)!g&&x in h||(g||(g=Array.prototype.slice.call(h,0,x)),g[x]=h[x]);return y.concat(g||Array.prototype.slice.call(h))},q=I.posix||I,A="/";(function(y){y.joinPath=function(h){for(var p=[],g=1;g<arguments.length;g++)p[g-1]=arguments[g];return h.with({path:q.join.apply(q,W([h.path],p,!1))})},y.resolvePath=function(h){for(var p=[],g=1;g<arguments.length;g++)p[g-1]=arguments[g];var x=h.path,k=!1;x[0]!==A&&(x=A+x,k=!0);var O=q.resolve.apply(q,W([x],p,!1));return k&&O[0]===A&&!h.authority&&(O=O.substring(1)),h.with({path:O})},y.dirname=function(h){if(h.path.length===0||h.path===A)return h;var p=q.dirname(h.path);return p.length===1&&p.charCodeAt(0)===46&&(p=""),h.with({path:p})},y.basename=function(h){return q.basename(h.path)},y.extname=function(h){return q.extname(h.path)}})(b||(b={}))})(),Xn=n})();var{URI:Tt,Utils:Na}=Xn;var ni=require("child_process"),ii=we(require("readline")),kt=require("coc.nvim");var he=require("coc.nvim"),Ze=we(_e());var Zn={warn:qe("warn"),info:qe("info"),error:qe("info")};function Et(e,t=!1){he.window.showErrorMessage(e),t&&he.window.showNotification({kind:"error",title:ie,content:e}),Zn.error(e)}function ei(e,t=!1){he.window.showWarningMessage(e),t&&he.window.showNotification({kind:"warning",title:ie,content:e}),Zn.warn(e)}var ti=e=>(0,Ze.existsSync)(e)&&(0,Ze.lstatSync)(e).isFile(),et=e=>e.replace(he.workspace.cwd+"/","");async function ri(e){let{nvim:t}=he.workspace;(await t.getOption("runtimepath")).split(",").includes(e)||await t.command(`execute 'noa set rtp+='.fnameescape('${e.replace(/'/g,"''")}')`)}var Pt=class{constructor(){this._tagsOnlyView=new Map(N.tags.map(t=>[t.tagName,[]]));this._flatView=new Map;this._treeView=new Map;this.mode=N.defaultView;this.groupByTag=N.groupByTag}flatView(t){let r=t.fsPath,n={index:t.index,tagName:t.tagName};return this._flatView.has(r)?this._flatView.get(r).push(n):this._flatView.set(r,[n]),this._flatView}tagsOnlyView(t){let r=t.tagName,n=t.index;return this._tagsOnlyView.has(r)?this._tagsOnlyView.get(r).push(n):this._tagsOnlyView.set(r,[n]),this._tagsOnlyView}treeView(t){let{tagName:r,index:n,fsPath:i}=t,o=i.split("/").filter(c=>c),s=this._treeView;return o.forEach((c,a,m)=>{let u=s.get(c);if(m[a+1])if(u)u&&(s=u);else{let f=new Map;s.set(c,f),s=f}else{let f={tagName:r,index:n},l=s.get(c);if(Array.isArray(l))l.push(f);else{let d=[f];s.set(c,d),s=d}}}),this._treeView}generateView(t){this.treeView(t),this.flatView(t),this.tagsOnlyView(t)}clear(){this._treeView.clear(),this._tagsOnlyView.clear(),this._flatView.clear()}get data(){let t=this[`_${this.mode}View`],r=Object.prototype.toString.call(t),n=!1;switch(r){case"[object Map]":{n=t.size!==0;break}default:case"[object Array]":{n=t.length!==0;break}}return n?this[`_${this.mode}View`]:null}switchToNextMode(){var r;let t=Z.findIndex(n=>n===this.mode);t!==-1?this.mode=(r=Z[t+1])!=null?r:Z[0]:this.mode=Z[1]}},Vs=new Pt,$=Vs;var Nt=N.maxGrepColumns,$s=N.maxPreviewWidth||Nt,Ms=N.customCommand,Ct=class{constructor(t){this.cwd=kt.workspace.cwd;this.currentProcess=null;this.resArr=[];this.grep=()=>new Promise(t=>{let r=this.grepString.split(" ");this.currentProcess=(0,ni.spawn)(r[0],r.slice(1),{cwd:this.cwd}),this.currentProcess.on("error",i=>{Et(i.message)}),this.currentProcess.stderr.on("data",i=>{Et(i.toString("utf8"))});let n=ii.default.createInterface(this.currentProcess.stdout);n.on("line",i=>{if(i){let o=Rs(i);o.shortText&&Ws(o.fsPath)&&(o.tagName=this.options.tagName,o.index=this.resArr.length,$.generateView(o),this.resArr.push(o))}}),n.on("close",()=>{t(this.resArr),this.currentProcess&&!this.currentProcess.killed&&this.currentProcess.kill()})});this.options=t,this.grepString=this.genGrepString()}genGrepString(){return this.options.regex?(Ms||`rg --no-messages --vimgrep -H --column --max-columns ${Nt} --max-columns-preview --line-number --color never -e`)+` ${this.options.regex} -- ${kt.workspace.cwd}`:'echo ""'}handleGrepCancel(){return this.currentProcess&&!this.currentProcess.killed?(this.currentProcess.kill(),this.resArr):[]}},oi=Ct;function Ws(e){let t=N.filterFilesRegex;return Array.isArray(t)?!t.some(r=>new RegExp(r).test(e)):!0}function Rs(e){var m,u;let t=RegExp(/^(?<file>.*):(?<line>\d+):(?<column>\d+):(?<tag>.*)/),r,n,i,o,s=t.exec(e);if(s&&s.groups)r=s.groups.file,n=parseInt(s.groups.line),i=parseInt(s.groups.column),o=s.groups.tag;else{r="",e.length>1&&e[1]===":"&&(r=e.substring(0,2),e=e.substring(2));let f=e.split(":"),l=f.length===4;r+=f.shift(),n=parseInt((m=f.shift())!=null?m:""),l===!0?i=parseInt((u=f.shift())!=null?u:""):i=1,o=f.join(":")}let c=[];o=Array.from({length:Math.min($s,o.length,Nt)},(f,l)=>l+(i-1)).map((f,l)=>(l<40&&c.push(o[f]),o[f])).join("");let a=c.join("");return{tagName:"",detail:o,shortText:/\[\.\.\.\u0020\d+\u0020more\u0020matches\]/.test(o)?"":a,line:n,fsPath:r,column:i}}function Ft(e){let t=[],r=$.data,n=N.tags.map(i=>i.tagName);return r&&Array.isArray(n)&&n.length&&n.forEach(i=>{let o=e.find(s=>{var c;return((c=s[0])==null?void 0:c.tagName)===i});o&&t.push({level:0,key:i,tag:i,sourcePath:i,children:Array.from(r.keys()).reduce((s,c)=>{let m=r.get(c).filter(f=>f.tagName===i),u={level:1,sourcePath:c,key:`${i}.${c}`,children:m.map(f=>o[f.index])};return u.children.length&&s.push(u),s},[]).sort((s,c)=>s.sourcePath.localeCompare(c.sourcePath))})}),t}function It(e){let t=[],r=$.data;return r&&r.forEach((n,i)=>{t.push({level:0,key:i,sourcePath:i,children:n.reduce((o,s)=>{let c=e.find(a=>{var m;return((m=a[0])==null?void 0:m.tagName)===s.tagName});return c&&o.push(c[s.index]),o},[])})}),t.sort((n,i)=>n.sourcePath.localeCompare(i.sourcePath))}function bt(e){return e.reduce((r,n)=>{if(Array.isArray(n)&&n.length>0){let i=n[0].tagName;r.push({level:0,tag:i,key:i,sourcePath:i,children:n.map(o=>M(o)?o:{...o,extra:`${et(o.path)}: ${o.range.start.line}, ${o.range.start.character}`})})}return r},[])}function Ot(e){return e.reduce((r,n)=>(r.push(...n.map(i=>M(i)?i:{...i,extra:`${et(i.path)}: ${i.range.start.line}, ${i.range.start.character}`})),r),[])}var tt=require("coc.nvim"),rt=we(_e()),si=(e,t)=>{let r=e?ai(e).reverse():[],n=ai(t).reverse().find(i=>r.includes(i.sourcePath));return n?n.sourcePath:null};function ui(e){function t(r){for(let n=0;n<r.length;n++){let i=r[n];if(M(i)&&(i.children.length>0&&t(i.children),i.children.length===0)){let o=r.findIndex(s=>M(s)&&i.key===s.key);r.splice(o,1),n--}}}t(e)}function ai(e){return JSON.parse(JSON.stringify(e))}var nt=e=>e.map(t=>t.sourcePath===tt.workspace.cwd?{...t,parentPaths:null}:t).sort((t,r)=>t.level-r.level).reduce((t,{sourcePath:r,parentPaths:n,children:i,...o})=>{var s;return t.get(si(n,e)).push({...o,sourcePath:r,name:r.replace(((s=si(n,e))!=null?s:tt.workspace.cwd)+"/",""),children:ti(r)?i:t.set(r,[]).get(r)}),t},new Map([[null,[]]])).get(null).reduce((t,r,n)=>(n===0&&r.sourcePath===tt.workspace.cwd?t=r.children:t.push(r),t),[]),it=e=>e.reduce((t,r)=>(M(r)&&((0,rt.existsSync)(r.sourcePath)&&(0,rt.lstatSync)(r.sourcePath).isFile()||r.children.length>1)&&t.push(r),t),[]),Ae=(e,t=[])=>Array.prototype.concat.apply(e.map(r=>r).reduce((r,n)=>(n&&r.push({...n,parentPaths:t}),r),[]),e.map(r=>M(r)?Ae(r.children,[...t,r.sourcePath]):[]));function _t(e){let t=[],r=N.tags.map(i=>i.tagName);function n(i,o,s=0,c=""){let a=[];if(Array.isArray(o)){let u=e.findIndex(f=>{var l;return((l=f[0])==null?void 0:l.tagName)===i});u!==-1&&(a=e[u].filter(f=>f.path===`${c}`))}else{let u=s+1;a=Array.from(o.keys()).map(f=>{let l=o.get(f),d=`${c}/${f}`;return{level:u,sourcePath:d,key:`[${i}] [${u}] ${d}`,children:n(i,l,u,d)}})}let m=a.sort((u,f)=>M(u)&&M(f)?u.sourcePath.localeCompare(f.sourcePath):0);return ui(m),m}return r.forEach(i=>{if(e.find(s=>{var c;return((c=s[0])==null?void 0:c.tagName)===i})){let s=nt(it(Ae(n(i,$.data))));t.push({level:0,sourcePath:i,key:i,tag:i,children:s})}}),t}function qt(e){function t(n,i=0,o=""){let s=[];return Array.isArray(n)?N.tags.forEach(({tagName:c})=>{let a=n.filter(u=>u.tagName===c),m=e.find(u=>{var f;return((f=u[0])==null?void 0:f.tagName)===c});if(a.length&&!!m){let u=a.map(f=>m[f.index]).filter(f=>f.path===o);s.push(...u)}}):s=Array.from(n.keys()).map(c=>{let a=`${o}/${c}`,m=n.get(c),u=t(m,i+1,a).sort((f,l)=>M(f)&&M(l)?f.sourcePath.localeCompare(l.sourcePath):0);return{level:i,sourcePath:a,key:`[${i}] ${a}`,children:u}}),s}return nt(it(Ae($.data?t($.data):[])))}function At(e){if($.groupByTag)switch($.mode){case Z[0]:return bt(e);case Z[2]:return _t(e);default:case Z[1]:return Ft(e)}else switch($.mode){case Z[0]:return Ot(e);case Z[2]:return qt(e);default:case Z[1]:return It(e)}}var Dt=class{constructor(){this.disposables=[];this.rootItems=[];this._treeView=null;this.opened=[];this.nvim=V.workspace.nvim;this.emitter=new V.Emitter;this.timeout=null;this.fetching=!1;this.autoPreview=N.autoPreview;this.commandsMap=new Map;this.autocmdsArr=Array();this.generateCommands(),this.generateAutocmds()}get treeView(){return this._treeView||this.generateTreeView(),this._treeView}set treeView(t){}generateCommands(){return this.commandsMap.set("showTree",{callback:async()=>{if(this.treeView&&!this.treeView.visible){this.autocmdsArr.map(n=>V.events.on(n.event,n.callback,null,this.disposables));let r=(await V.workspace.document).bufnr;this.prevBufnr=await this.nvim.call("bufwinnr",[r]),await this.treeView.show()}this.refreshTodoItems()},args:void 0}).set("goTo",{callback:t=>ci(t,this.nvim,this.prevBufnr),args:void 0,internal:!0}).set("open",{callback:()=>{},args:void 0,internal:!0}),this.commandsMap}generateAutocmds(){return this.autocmdsArr.push({event:"BufWritePost",callback:()=>{var t;(t=this.treeView)!=null&&t.visible&&this.refreshTodoItems(500)}}),this.autocmdsArr.push({event:"BufEnter",callback:t=>{var r;((r=this._treeView)==null?void 0:r.visible)&&this.previewBufnr&&t!==this.previewBufnr&&(this.prevNode=void 0,this.closePreview())}}),this.autocmdsArr}refreshTodoItems(t=0){this.fetching||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(async()=>{let r="Updating items...";await V.window.withProgress({title:`[${ie}] ${r}`,cancellable:!0},async(n,i)=>{let o="";this._treeView.nodesMap.clear(),$.clear(),this._treeView.message=o;let s=0,c=N.tags.map(a=>new oi({regex:a.regex,tagName:a.tagName}));return i.onCancellationRequested(()=>{let a="Grep canceled";o=`${a}: `,ei(a);let m=c.map(u=>(s+=u.resArr.length,fi(u.handleGrepCancel())));this.rootItems=At(m)}),new Promise(a=>{this.fetching=!0,this.rootItems=[],o="All ",Promise.all(c.map(async m=>fi(await m.grep()))).then(m=>{c.forEach(u=>s+=u.resArr.length),this._treeView.message=o+`${s} items`,this._treeView.description=`${$.groupByTag?"group by tag;":""} ${$.mode} view`,this.rootItems=At(m),a()})})}),this.emitter.fire(void 0),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.fetching=!1},t))}generateTreeView(){let t={resolveActions:async(r,n)=>[{title:"open it and close tree",handler:async()=>{let o=(await V.workspace.document).bufnr,s=await this.nvim.call("bufwinnr",[o]);await ci(n,this.nvim,this.prevBufnr),await this.nvim.command(`${s}wincmd c`)}}],onDidChangeTreeData:this.emitter.event,getChildren:r=>{if(!r)return this.rootItems;if(M(r))return r.children},getTreeItem:r=>{var i,o,s,c,a,m,u,f,l,d,w,v,T,S;let n;if(M(r)){let C,P,G="",re=this.opened.findIndex(Q=>Q.key===r.key)!==-1?V.TreeItemCollapsibleState.Expanded:V.TreeItemCollapsibleState.Collapsed,X="";if(typeof r.tag=="string"){let Q=N.tags.find(oe=>oe.tagName===r.tag);Q&&(C=(i=Q==null?void 0:Q.icon)==null?void 0:i.text,X=r.tag,P=((o=N)==null?void 0:o.groupTagIconHighlight)||((s=Q.icon)==null?void 0:s.hlGroup))}else G=r.sourcePath.replace(V.workspace.cwd+"/",""),(0,li.lstatSync)(r.sourcePath).isFile()?(C=(a=(c=N)==null?void 0:c.fileIcon)==null?void 0:a.text,P=(u=(m=N)==null?void 0:m.fileIcon)==null?void 0:u.hlGroup):(C=(l=(f=N)==null?void 0:f.folderIcon)==null?void 0:l.text,P=(w=(d=N)==null?void 0:d.folderIcon)==null?void 0:w.hlGroup),X=(v=r.name)!=null?v:hi.default.basename(Tt.file(r.sourcePath).path);n=new V.TreeItem(X,re),n.command={command:`${ie}.open`,title:"open it",arguments:[r]},n.description=G,N.parentNodeHighlightEnabled&&(n.label={highlights:[[0,X.length]],label:X}),C&&(n.icon={hlGroup:P||ye.fileIcon.hlGroup,text:C})}else{let{shortText:C}=r,P=(T=N.tags.find(re=>re.tagName===r.tagName))==null?void 0:T.icon;n=new V.TreeItem(`${C}`,V.TreeItemCollapsibleState.None);let G=(S=r.extra)!=null?S:`[${r.range.start.line}, ${r.range.start.character}]`;P&&(n.icon={hlGroup:P==null?void 0:P.hlGroup,text:P==null?void 0:P.text}),n.command={command:`${ie}.goTo`,title:"go to it",arguments:[r]},n.description=G}return n}};return this._treeView=V.window.createTreeView("Todo",{treeDataProvider:t,bufhidden:"hide",autoWidth:!0}),this._treeView.onDidExpandElement(({element:r})=>{if(M(r)){let{key:n}=r;if(this.opened.find(i=>i.key===n))return;this.opened.push({key:n})}}),this._treeView.onDidCollapseElement(({element:r})=>{if(M(r)){let{key:n}=r,i=this.opened.findIndex(o=>o.key===n);i!==-1&&this.opened.splice(i,1)}}),this._treeView._collapseAll=this._treeView.collapseAll,this._treeView.collapseAll=(...r)=>{this._treeView._collapseAll(...r),this.opened=[]},this._treeView.onDidChangeVisibility(({visible:r})=>{r||(this.closePreview(),(0,V.disposeAll)(this.disposables))}),this._treeView.registerLocalKeymap("n",N.toggleGroupByTagKey,async()=>{this.closePreview(),$.groupByTag=!$.groupByTag,this.refreshTodoItems()},!0),this._treeView.registerLocalKeymap("n",N.refreshItemsKey,async()=>{this.closePreview(),this.refreshTodoItems()},!0),this._treeView.registerLocalKeymap("n",N.togglePreviewKey,async r=>{this.autoPreview=!this.autoPreview,this.doPreview(r)},!0),this._treeView.registerLocalKeymap("n",N.switchViewKey,async()=>{this.opened=[],$.switchToNextMode(),this.closePreview(),this.refreshTodoItems()},!0),this._treeView.onDidCursorMoved(async r=>{this.prevNode!==r&&(this.prevNode=r,this.previewBufnr=await this.doPreview(r))}),this._treeView}async doPreview(t){var r,n,i,o,s,c,a,m,u,f,l,d,w,v,T,S;if(t&&this.autoPreview){let C={lines:[],border:(i=(r=N.previewWinConfig)==null?void 0:r.border)!=null?i:(n=ye.previewWinConfig)==null?void 0:n.border,rounded:(c=(o=N.previewWinConfig)==null?void 0:o.rounded)!=null?c:(s=ye.previewWinConfig)==null?void 0:s.rounded,maxWidth:N.maxPreviewWidth,highlight:(u=(a=N.previewWinConfig)==null?void 0:a.highlight)!=null?u:(m=ye.previewWinConfig)==null?void 0:m.highlight,borderhighlight:(d=(f=N.previewWinConfig)==null?void 0:f.borderhighlight)!=null?d:(l=ye.previewWinConfig)==null?void 0:l.borderhighlight,winblend:(T=(w=N.previewWinConfig)==null?void 0:w.winblend)!=null?T:(v=ye.previewWinConfig)==null?void 0:v.winblend,filetype:"text"};if(M(t)){if(t.tag){this.closePreview();return}else C.lines.push(t.sourcePath.replace(V.workspace.cwd+"/",""));C.maxWidth=1e3}else if(!M(t)){let P=(S=t.extra)!=null?S:`[Line ${t.range.start.line}, Col ${t.range.start.character}]`,G=`${t.detail}

${P}`;C.lines=(G==null?void 0:G.split(`
`))||[]}return await this.nvim.call("coc_todo_tree#preview",C)}else this.closePreview()}closePreview(){this.nvim.call("coc_todo_tree#close_preview",[],!0)}},mi=Dt;function M(e){return!!Object.prototype.hasOwnProperty.call(e,"sourcePath")}async function ci(e,t,r){if(!M(e)){let n=Tt.file(e.path).toString();await t.command(`${r!=null?r:""}wincmd w`),await V.workspace.jumpTo(n,{line:e.range.start.line-1,character:e.range.start.character-1})}}function fi(e){return e.map(t=>({tagName:t.tagName,detail:t.detail,shortText:t.shortText,path:t.fsPath,range:{start:{character:t.column,line:t.line},end:{character:t.column,line:t.line}}}))}var di=require("coc.nvim");var pi;function qe(e){return t=>pi[e](t)}async function js(e){if(N.enabled===!1)return;let{subscriptions:t,logger:r}=e;pi=r;let n=new mi;process.debugPort!==6989&&await ri(e.extensionPath),t.push(...Ls(ie,n.commandsMap))}function Ls(e,t){return Array.from(t.keys()).map(r=>{let{callback:n,args:i,internal:o}=t.get(r);return di.commands.registerCommand(`${e}.${r}`,n,i,o)})}0&&(module.exports={activate,log});
